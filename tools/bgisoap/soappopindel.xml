<tool id="soappopindel" name="SOAPpopindel" version="0.1">
    <description>- detection of splice junctions</description>
    <command interpreter="python">
        soappopindel.py

        ## Inputs
        --depth=$depth
        --ploidy=$ploidy

        ## Output file in VCF format
        --output=$output

    </command>
    <requirements>
        <requirement type="package">bgisoap</requirement>
    </requirements>
    <inputs>
        <param name="depth" type="data" label="Depth file" help="See documentation below for information on this format"/>
        <param name="ploidy" type="integer" label="Ploidy" value="2"/>
    </inputs>
    <outputs>
        <data name="output" type="data" label="VCF result"/>
    </outputs>
    <tests>
        <test>
            <!--
                soapPopIndel -i all.txt -v all.vcf -p 2
            -->
            <param name="depth" value="indexed" />
            <param name="ploidy" value="2" />
            <output name="output" file="bwa_wrapper_out1.sam" ftype="sam" sort="True" />
        </test>
    </tests>
    <help>

**What it does**

SOAP-PopIndel is a novel probabilistic framework for fast and sensitive indel genotyping at the population level. This tool was created by Haojing Shao and Hanjiudai Yin at BGI.

-----

**Tool parameters**

Depth file:

The depth file is a temporary data format used for storing supporting read information. It could be generated by your raw data, realignment or other. The format for a depth file is as follows:

First line:

Chromosome Position Non-reference_allele 1 (Non-reference_allele 2) (Non-reference_allele 3)

Second line:

Number of supporting reference read counts for sample 1, sample 2,sample N

Third line:

Number of supporting first non-reference allele read counts for sample 1, sample 2, sample N

Fourth line: (if your first line indicate more than 1 non-reference allele)

Number of supporting second non-reference allele read counts for sample 1, sample 2, sample N

Fifth line and so on.

Example depth file:

Chromosome1	1000	DA	DAA
16 19 0 0 21 21 16 20 0 40 23 0 0 40 0 0 19 40 20 40
0 21 19 22 0 19 0 0 23 0 0 40 40 0 19 22 21 0 0 0
24 0 21 18 19 0 24 20 17 0 17 0 0 0 21 18 0 0 20 0
Chromosome2	2000	IA
22 40 40 24 0 25 18 0 0 0 0 0 22 0 21 22 0 40 0 15
18 0 0 16 40 15 22 40 40 40 40 40 18 40 19 18 40 0 40 25

Ploidy:

Input the ploidy. 1 for haploid , 2 for diploid , 3 for triploid and so on

VCF output

The results of SOAPpopindel are in Variant Call Format (VCF). Further information on VCF can be obtained at http://www.1000genomes.org/node/101 .

-----

**Bugs and suggestions**

Please contact shaohj@genomics.cn.

-----

**More information**

For test data and more detailed information, click here_.

.. _here: http://soap.genomics.org.cn/SOAP-popIndel.html

    </help>
</tool>


